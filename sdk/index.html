
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Freeact code action agent">
      
      
      
        <link rel="canonical" href="https://gradion-ai.github.io/freeact/sdk/">
      
      
        <link rel="prev" href="../sandbox/">
      
      
        <link rel="next" href="../cli/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>Agent SDK - freeact</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Inter:300,300i,400,400i,700,700i%7CJetBrains+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Inter";--md-code-font:"JetBrains Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../stylesheets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="custom">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#agent-sdk" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="freeact" class="md-header__button md-logo" aria-label="freeact" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            freeact
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Agent SDK
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/gradion-ai/freeact" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    gradion-ai/freeact
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href=".." class="md-tabs__link">
          
  
  
  Documentation

        </a>
      </li>
    
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../api/agent/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="freeact" class="md-nav__button md-logo" aria-label="freeact" data-md-component="logo">
      
  <img src="../images/logo.png" alt="logo">

    </a>
    freeact
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/gradion-ai/freeact" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    gradion-ai/freeact
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" checked>
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Documentation
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    Documentation
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Installation
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quickstart
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuration
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../execution/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Execution
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sandbox/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sandbox Mode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Agent SDK
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Agent SDK
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration API
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generation-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generation API
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agent-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Agent API
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Agent API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    <span class="md-ellipsis">
      
        Events
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internal-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Internal tools
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turn-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Turn limits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subagents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Subagents
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approval" class="md-nav__link">
    <span class="md-ellipsis">
      
        Approval
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lifecycle
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeouts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Timeouts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#persistence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Persistence
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permissions-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Permissions API
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    CLI Tool
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_9" >
        
          
          <label class="md-nav__link" for="__nav_1_9" id="__nav_1_9_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    Examples
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_9">
            <span class="md-nav__icon md-icon"></span>
            
  
    Examples
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/output-parser/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Enhancing Tools
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/saving-codeacts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Code Action Reuse
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/agent-skills/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Custom Agent Skills
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/sandbox-mode/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Sandbox Mode
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../examples/python-packages/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Data Analysis
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
          
          
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1_10" >
        
          
          <label class="md-nav__link" for="__nav_1_10" id="__nav_1_10_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    LLM readable
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_1_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1_10">
            <span class="md-nav__icon md-icon"></span>
            
  
    LLM readable
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llms.txt" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    llms.txt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../llms-full.txt" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    llms-full.txt
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    API Reference
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    API Reference
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Agent
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/config/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Config
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/generate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Generate
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/permissions/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Permissions
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#configuration-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuration API
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#generation-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Generation API
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#agent-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Agent API
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Agent API">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#events" class="md-nav__link">
    <span class="md-ellipsis">
      
        Events
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#internal-tools" class="md-nav__link">
    <span class="md-ellipsis">
      
        Internal tools
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#turn-limits" class="md-nav__link">
    <span class="md-ellipsis">
      
        Turn limits
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#subagents" class="md-nav__link">
    <span class="md-ellipsis">
      
        Subagents
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#approval" class="md-nav__link">
    <span class="md-ellipsis">
      
        Approval
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#lifecycle" class="md-nav__link">
    <span class="md-ellipsis">
      
        Lifecycle
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#timeouts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Timeouts
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#persistence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Persistence
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#permissions-api" class="md-nav__link">
    <span class="md-ellipsis">
      
        Permissions API
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="agent-sdk">Agent SDK</h1>
<p>The Agent SDK provides four main APIs:</p>
<ul>
<li><a href="../api/config/">Configuration API</a> for initializing and loading configuration from <code>.freeact/</code></li>
<li><a href="../api/generate/">Generation API</a> for generating Python APIs for MCP server tools</li>
<li><a href="../api/agent/">Agent API</a> for running the agentic code action loop</li>
<li><a href="../api/permissions/">Permissions API</a> for managing approval decisions</li>
</ul>
<h2 id="configuration-api">Configuration API</h2>
<p>Use <a class="autorefs autorefs-internal" href="../api/config/#freeact.agent.config.Config.init"><code>Config.init()</code></a> to scaffold the <code>.freeact/</code> directory from default templates. The <a class="autorefs autorefs-internal" href="../api/config/#freeact.agent.config.Config"><code>Config()</code></a> constructor loads all configuration from it:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">freeact.agent.config</span><span class="w"> </span><span class="kn">import</span> <span class="n">Config</span>

<span class="c1"># Scaffold .freeact/ config directory if needed</span>
<span class="k">await</span> <span class="n">Config</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>

<span class="c1"># Load configuration from .freeact/</span>
<span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
</code></pre></div>
<p>See the <a href="../configuration/">Configuration</a> reference for details on the <code>.freeact/</code> directory structure.</p>
<h2 id="generation-api">Generation API</h2>
<p>MCP servers <a href="../configuration/#ptc-servers">configured</a> as <code>ptc-servers</code> in <code>config.json</code> require Python API generation with <a class="autorefs autorefs-internal" href="../api/generate/#freeact.tools.pytools.apigen.generate_mcp_sources"><code>generate_mcp_sources()</code></a> before the agent can call their tools programmatically:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">freeact.tools.pytools.apigen</span><span class="w"> </span><span class="kn">import</span> <span class="n">generate_mcp_sources</span>

<span class="c1"># Generate Python APIs for MCP servers in ptc_servers</span>
<span class="k">for</span> <span class="n">server_name</span><span class="p">,</span> <span class="n">params</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">ptc_servers</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">generated_dir</span> <span class="o">/</span> <span class="s2">&quot;mcptools&quot;</span> <span class="o">/</span> <span class="n">server_name</span><span class="p">)</span><span class="o">.</span><span class="n">exists</span><span class="p">():</span>
        <span class="k">await</span> <span class="n">generate_mcp_sources</span><span class="p">({</span><span class="n">server_name</span><span class="p">:</span> <span class="n">params</span><span class="p">},</span> <span class="n">config</span><span class="o">.</span><span class="n">generated_dir</span><span class="p">)</span>
</code></pre></div>
<p>Generated APIs are stored as <code>.freeact/generated/mcptools/&lt;server_name&gt;/&lt;tool&gt;.py</code> modules and persist across agent sessions. The <code>.freeact/generated/</code> directory is on the kernel's <code>PYTHONPATH</code>, so the agent can import them directly:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">mcptools.google.web_search</span><span class="w"> </span><span class="kn">import</span> <span class="n">run</span><span class="p">,</span> <span class="n">Params</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">run</span><span class="p">(</span><span class="n">Params</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="s2">&quot;python async tutorial&quot;</span><span class="p">))</span>
</code></pre></div>
<h2 id="agent-api">Agent API</h2>
<p>The <a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.Agent"><code>Agent</code></a> class implements the agentic code action loop, handling code action generation, <a href="../execution/">code execution</a>, tool calls, and the approval workflow. Each <a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.Agent.stream"><code>stream()</code></a> call runs a single agent turn, with the agent managing conversation history across calls. Use <code>stream()</code> to iterate over <a href="#events">events</a> and handle them with pattern matching:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">freeact.agent</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">Agent</span><span class="p">,</span>
    <span class="n">ApprovalRequest</span><span class="p">,</span>
    <span class="n">CodeExecutionOutput</span><span class="p">,</span>
    <span class="n">Response</span><span class="p">,</span>
    <span class="n">Thoughts</span><span class="p">,</span>
    <span class="n">ToolOutput</span><span class="p">,</span>
<span class="p">)</span>

<span class="k">async</span> <span class="k">with</span> <span class="n">Agent</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">agent</span><span class="p">:</span>
    <span class="n">prompt</span> <span class="o">=</span> <span class="s2">&quot;Who is the F1 world champion 2025?&quot;</span>

    <span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">agent</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">prompt</span><span class="p">):</span>
        <span class="k">match</span> <span class="n">event</span><span class="p">:</span>
            <span class="k">case</span> <span class="n">ApprovalRequest</span><span class="p">(</span><span class="n">tool_name</span><span class="o">=</span><span class="s2">&quot;ipybox_execute_ipython_cell&quot;</span><span class="p">,</span> <span class="n">tool_args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Code action:</span><span class="se">\n</span><span class="si">{</span><span class="n">args</span><span class="p">[</span><span class="s1">&#39;code&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">request</span><span class="o">.</span><span class="n">approve</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ApprovalRequest</span><span class="p">(</span><span class="n">tool_name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">tool_args</span><span class="o">=</span><span class="n">args</span><span class="p">)</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool: </span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Args: </span><span class="si">{</span><span class="n">args</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="n">request</span><span class="o">.</span><span class="n">approve</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">Thoughts</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Thinking: </span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">CodeExecutionOutput</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">text</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Code execution output: </span><span class="si">{</span><span class="n">text</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">ToolOutput</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool call result: </span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">case</span> <span class="n">Response</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</code></pre></div>
<p>For processing output incrementally, match the <code>*Chunk</code> event variants listed below.</p>
<h3 id="events">Events</h3>
<p>The <a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.Agent.stream"><code>Agent.stream()</code></a> method yields events as they occur:</p>
<table>
<thead>
<tr>
<th>Event</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.ThoughtsChunk"><code>ThoughtsChunk</code></a></td>
<td>Partial model thoughts (content streaming)</td>
</tr>
<tr>
<td><a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.Thoughts"><code>Thoughts</code></a></td>
<td>Complete model thoughts at a given step</td>
</tr>
<tr>
<td><a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.ResponseChunk"><code>ResponseChunk</code></a></td>
<td>Partial model response (content streaming)</td>
</tr>
<tr>
<td><a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.Response"><code>Response</code></a></td>
<td>Complete model response</td>
</tr>
<tr>
<td><a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.ApprovalRequest"><code>ApprovalRequest</code></a></td>
<td>Pending code action or tool call approval</td>
</tr>
<tr>
<td><a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.CodeExecutionOutputChunk"><code>CodeExecutionOutputChunk</code></a></td>
<td>Partial code execution output (content streaming)</td>
</tr>
<tr>
<td><a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.CodeExecutionOutput"><code>CodeExecutionOutput</code></a></td>
<td>Complete code execution output</td>
</tr>
<tr>
<td><a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.ToolOutput"><code>ToolOutput</code></a></td>
<td>Tool or built-in operation output</td>
</tr>
</tbody>
</table>
<p>All yielded events inherit from <a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.AgentEvent"><code>AgentEvent</code></a> and carry <code>agent_id</code>.</p>
<h3 id="internal-tools">Internal tools</h3>
<p>The agent uses a small set of internal tools for reading and writing files, executing code and commands, spawning subagents, and discovering tools:</p>
<table>
<thead>
<tr>
<th>Tool</th>
<th>Implementation</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>read, write</td>
<td><a class="autorefs autorefs-internal" href="../api/config/#freeact.agent.config.FILESYSTEM_CONFIG"><code>filesystem</code></a> MCP server</td>
<td>Reading and writing files via JSON tool calls</td>
</tr>
<tr>
<td>execute</td>
<td><code>ipybox_execute_ipython_cell</code></td>
<td>Execution of Python code and shell commands (via <code>!</code> prefix), delegated to ipybox's <code>CodeExecutor</code></td>
</tr>
<tr>
<td>subagent</td>
<td><a href="#subagents"><code>subagent_task</code></a></td>
<td>Task delegation to child agents</td>
</tr>
<tr>
<td>tool search</td>
<td><code>pytools</code> MCP server for <a class="autorefs autorefs-internal" href="../api/config/#freeact.agent.config.PYTOOLS_BASIC_CONFIG">basic search</a> and <a class="autorefs autorefs-internal" href="../api/config/#freeact.agent.config.PYTOOLS_HYBRID_CONFIG">hybrid search</a></td>
<td>Tool discovery via category browsing or hybrid search</td>
</tr>
</tbody>
</table>
<h3 id="turn-limits">Turn limits</h3>
<p>Use <code>max_turns</code> to limit the number of tool-execution rounds before the stream stops:</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">agent</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">prompt</span><span class="p">,</span> <span class="n">max_turns</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="o">...</span>
</code></pre></div>
<p>If <code>max_turns=None</code> (default), the loop continues until the model produces a final response.</p>
<h3 id="subagents">Subagents</h3>
<p>The built-in <code>subagent_task</code> tool delegates a subtask to a child agent with a fresh IPython kernel and fresh MCP server connections. The child inherits model, system prompt, and sandbox settings from the parent. Its events flow through the parent's stream using the same <a href="#approval">approval</a> mechanism, with <code>agent_id</code> identifying the source:</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">agent</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">prompt</span><span class="p">):</span>
    <span class="k">match</span> <span class="n">event</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">ApprovalRequest</span><span class="p">(</span><span class="n">agent_id</span><span class="o">=</span><span class="n">agent_id</span><span class="p">)</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">agent_id</span><span class="si">}</span><span class="s2">] Approve </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">?&quot;</span><span class="p">)</span>
            <span class="n">request</span><span class="o">.</span><span class="n">approve</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">case</span> <span class="n">Response</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">,</span> <span class="n">agent_id</span><span class="o">=</span><span class="n">agent_id</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="n">agent_id</span><span class="si">}</span><span class="s2">] </span><span class="si">{</span><span class="n">content</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<p>The main agent's <code>agent_id</code> is <code>main</code>, subagent IDs use the form <code>sub-xxxx</code>. Each delegated task defaults to <code>max_turns=100</code>. The <a href="../configuration/#agent-settings"><code>max-subagents</code></a> setting in <code>config.json</code> limits concurrent subagents (default 5).</p>
<h3 id="approval">Approval</h3>
<p>The agent provides a unified approval mechanism. It yields <a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.ApprovalRequest"><code>ApprovalRequest</code></a> for all code actions, programmatic tool calls, and JSON tool calls. Execution is suspended until <code>approve()</code> is called. Calling <code>approve(True)</code> executes the code action or tool call; <code>approve(False)</code> rejects it and ends the current agent turn.</p>
<div class="highlight"><pre><span></span><code><span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">agent</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">prompt</span><span class="p">):</span>
    <span class="k">match</span> <span class="n">event</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">ApprovalRequest</span><span class="p">()</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
            <span class="c1"># Inspect the pending action</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tool: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">tool_name</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Args: </span><span class="si">{</span><span class="n">request</span><span class="o">.</span><span class="n">tool_args</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

            <span class="c1"># Approve or reject</span>
            <span class="n">request</span><span class="o">.</span><span class="n">approve</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">case</span> <span class="n">Response</span><span class="p">(</span><span class="n">content</span><span class="o">=</span><span class="n">content</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">content</span><span class="p">)</span>
</code></pre></div>
<div class="admonition note">
<p class="admonition-title">Code action approval</p>
<p>For code actions, <code>tool_name</code> is <code>ipybox_execute_ipython_cell</code> and <code>tool_args</code> contains the <code>code</code> to execute.</p>
</div>
<h3 id="lifecycle">Lifecycle</h3>
<p>The agent manages MCP server connections and an IPython kernel via <a href="https://gradion-ai.github.io/ipybox/">ipybox</a>. On entering the async context manager, the IPython kernel starts and MCP servers configured for JSON tool calling connect. MCP servers configured for programmatic tool calling connect lazily on first tool call.</p>
<div class="highlight"><pre><span></span><code><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">Agent</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span> <span class="k">as</span> <span class="n">agent</span><span class="p">:</span>
    <span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">agent</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">prompt</span><span class="p">):</span>
        <span class="o">...</span>
<span class="c1"># Connections closed, kernel stopped</span>
</code></pre></div>
<p>Without using the async context manager:</p>
<div class="highlight"><pre><span></span><code><span class="n">config</span> <span class="o">=</span> <span class="n">Config</span><span class="p">()</span>
<span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
<span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">agent</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">prompt</span><span class="p">):</span>
        <span class="o">...</span>
<span class="k">finally</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">agent</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
</code></pre></div>
<h3 id="timeouts">Timeouts</h3>
<p>The agent supports two timeout settings in <a href="../configuration/#agent-settings"><code>config.json</code></a>:</p>
<ul>
<li><strong><code>execution-timeout</code></strong>: Maximum time in seconds for each <a href="../execution/">code execution</a>. Approval wait time is excluded from this budget, so the timeout only counts actual execution time. Defaults to 300 seconds. Set to <code>null</code> to disable.</li>
<li><strong><code>approval-timeout</code></strong>: Timeout for approval requests during programmatic tool calls. If an approval request is not accepted or rejected within this time, the tool call fails. Defaults to <code>null</code> (no timeout).</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;execution-timeout&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;approval-timeout&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span>
<span class="p">}</span>
</code></pre></div>
<h3 id="persistence">Persistence</h3>
<p><a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.store.SessionStore"><code>SessionStore</code></a> persists agent message history to <code>.freeact/sessions/&lt;session-uuid&gt;/&lt;agent-id&gt;.jsonl</code>. Each agent turn appends messages incrementally, so the history is durable even if the process terminates mid-session.</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">freeact.agent.store</span><span class="w"> </span><span class="kn">import</span> <span class="n">SessionStore</span>

<span class="c1"># Create a session store with a new session ID</span>
<span class="n">session_id</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">())</span>
<span class="n">session_store</span> <span class="o">=</span> <span class="n">SessionStore</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">sessions_dir</span><span class="p">,</span> <span class="n">session_id</span><span class="p">)</span>
</code></pre></div>
<p>Pass the store to <a class="autorefs autorefs-internal" href="../api/agent/#freeact.agent.Agent"><code>Agent</code></a> to enable persistence.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Run agent with session persistence</span>
<span class="k">async</span> <span class="k">with</span> <span class="n">Agent</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">session_store</span><span class="o">=</span><span class="n">session_store</span><span class="p">)</span> <span class="k">as</span> <span class="n">agent</span><span class="p">:</span>
    <span class="k">await</span> <span class="n">handle_events</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="s2">&quot;What is the capital of France?&quot;</span><span class="p">)</span>
    <span class="k">await</span> <span class="n">handle_events</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="s2">&quot;What about Germany?&quot;</span><span class="p">)</span>
</code></pre></div>
<p>To resume a session, create a new <code>SessionStore</code> with the same <code>session_id</code>. The agent loads the persisted message history on startup and continues from where it left off.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Resume session with the same session ID</span>
<span class="n">session_store</span> <span class="o">=</span> <span class="n">SessionStore</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">sessions_dir</span><span class="p">,</span> <span class="n">session_id</span><span class="p">)</span>

<span class="k">async</span> <span class="k">with</span> <span class="n">Agent</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">,</span> <span class="n">session_store</span><span class="o">=</span><span class="n">session_store</span><span class="p">)</span> <span class="k">as</span> <span class="n">agent</span><span class="p">:</span>
    <span class="c1"># Previous message history is restored automatically</span>
    <span class="k">await</span> <span class="n">handle_events</span><span class="p">(</span><span class="n">agent</span><span class="p">,</span> <span class="s2">&quot;And what was the first country we discussed?&quot;</span><span class="p">)</span>
</code></pre></div>
<p>Only the main agent's message history (<code>main.jsonl</code>) is loaded on resume. Subagent messages are persisted to separate files (<code>sub-xxxx.jsonl</code>) for auditing but are not rehydrated.</p>
<p>The <a href="../cli/">CLI tool</a> accepts <code>--session-id</code> to resume a session from the command line.</p>
<h2 id="permissions-api">Permissions API</h2>
<div class="admonition info">
<p class="admonition-title">Work in progress</p>
<p>Current permission management is preliminary and will be reimplemented in a future release.</p>
</div>
<p>The agent requests approval for each code action and tool call but doesn't remember past decisions. <a class="autorefs autorefs-internal" href="../api/permissions/#freeact.permissions.PermissionManager"><code>PermissionManager</code></a> adds memory: <code>allow_always()</code> persists to <code>.freeact/permissions.json</code>, while <code>allow_session()</code> stores in-memory until the session ends:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">freeact.permissions</span><span class="w"> </span><span class="kn">import</span> <span class="n">PermissionManager</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">ipybox.utils</span><span class="w"> </span><span class="kn">import</span> <span class="n">arun</span>

<span class="n">manager</span> <span class="o">=</span> <span class="n">PermissionManager</span><span class="p">()</span>
<span class="k">await</span> <span class="n">manager</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="k">async</span> <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">agent</span><span class="o">.</span><span class="n">stream</span><span class="p">(</span><span class="n">prompt</span><span class="p">):</span>
    <span class="k">match</span> <span class="n">event</span><span class="p">:</span>
        <span class="k">case</span> <span class="n">ApprovalRequest</span><span class="p">()</span> <span class="k">as</span> <span class="n">request</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">manager</span><span class="o">.</span><span class="n">is_allowed</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">tool_name</span><span class="p">,</span> <span class="n">request</span><span class="o">.</span><span class="n">tool_args</span><span class="p">):</span>
                <span class="n">request</span><span class="o">.</span><span class="n">approve</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">choice</span> <span class="o">=</span> <span class="k">await</span> <span class="n">arun</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="s2">&quot;Allow? [Y/n/a/s]: &quot;</span><span class="p">)</span>
                <span class="k">match</span> <span class="n">choice</span><span class="p">:</span>
                    <span class="k">case</span> <span class="s2">&quot;a&quot;</span><span class="p">:</span>
                        <span class="k">await</span> <span class="n">manager</span><span class="o">.</span><span class="n">allow_always</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">tool_name</span><span class="p">)</span>
                        <span class="n">request</span><span class="o">.</span><span class="n">approve</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">case</span> <span class="s2">&quot;s&quot;</span><span class="p">:</span>
                        <span class="n">manager</span><span class="o">.</span><span class="n">allow_session</span><span class="p">(</span><span class="n">request</span><span class="o">.</span><span class="n">tool_name</span><span class="p">)</span>
                        <span class="n">request</span><span class="o">.</span><span class="n">approve</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="k">case</span> <span class="s2">&quot;n&quot;</span><span class="p">:</span>
                        <span class="n">request</span><span class="o">.</span><span class="n">approve</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                    <span class="k">case</span><span class="w"> </span><span class="k">_</span><span class="p">:</span>
                        <span class="n">request</span><span class="o">.</span><span class="n">approve</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2025-2026 Gradion AI
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.tabs", "navigation.sections", "navigation.instant", "navigation.instant.prefetch", "navigation.instant.preview", "navigation.instant.progress", "navigation.top", "navigation.tracking", "search.suggest", "toc.follow", "content.code.copy", "content.code.select", "content.code.annotate"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>